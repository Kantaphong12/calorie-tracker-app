import{e as B,d as C,Q as r,f as R,c as L}from"./option-sizes-CkKNlW_J.js";import{Q as f}from"./QRadio-DgikmgbP.js";import{d as D,r as o,R as i,U as u,Q as d,f as a,Y as w,X as x,S as m,P as I,Z as S,W as k,a6 as T,a9 as U,ab as P}from"./index-CEUefBMO.js";import"./use-dark-pvciDe5F.js";const j={class:"text-h6 text-center"},A={key:4,class:"q-px-sm"},E={class:"q-gutter-sm row"},G=D({__name:"LoginForm",setup(F){const q=P(),Q="https://api-w4ic.onrender.com",t=o(!1),y=o(""),v=o(""),p=o(""),N=o(""),n=o(!1),V=o(""),c=o(""),b=o(""),s=o("");function h(){t.value=!t.value}async function z(){if(n.value=!0,t.value){const g={name:y.value,email:v.value,password:p.value,gender:s.value,age:Number(V.value),weight:Number(c.value),height:Number(b.value)};try{const l=await fetch(`${Q}/api/Register`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!l.ok){const e=await l.text();throw new Error(e||"Registration successful")}U.create({type:"positive",position:"top-right",message:"สมัครสมาชิกสำเร็จ! กรุณาเข้าสู่ระบบ"}),h(),n.value=!1}catch(l){n.value=!1,console.error("error",l)}}else{const g={email:v.value,password:p.value},l=await fetch(`${Q}/api/Login`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(l.ok){const e=await l.json();console.log(e),localStorage.setItem("authToken",e.token),localStorage.setItem("UserID",e.user.id),q.replace("/calorie"),n.value=!1,U.create({type:"positive",position:"top-right",message:"Login successful!"})}else{const e=await l.text();if(e){U.create({type:"negative",position:"top-right",message:`Login Failed! ${e}`}),n.value=!1;return}n.value=!1}}}return(g,l)=>(d(),i(B,{class:"flex flex-center bg-grey-2"},{default:u(()=>[a(L,{style:{width:"400px","max-width":"90vw"}},{default:u(()=>[a(C,{class:"bg-primary text-white"},{default:u(()=>[w("div",j,x(t.value?"สมัครสมาชิกใหม่":"เข้าสู่ระบบ"),1)]),_:1}),a(C,{class:"q-gutter-md"},{default:u(()=>[t.value?(d(),i(r,{key:0,modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=e=>y.value=e),label:"ชื่อ-นามสกุล",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกชื่อ"]},null,8,["modelValue","rules"])):m("",!0),t.value?(d(),i(r,{key:1,modelValue:V.value,"onUpdate:modelValue":l[1]||(l[1]=e=>V.value=e),label:"อายุ",type:"number",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกอายุ"]},null,8,["modelValue","rules"])):m("",!0),t.value?(d(),i(r,{key:2,modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),label:"ส่วนสูง",type:"number",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกส่วนสูง"]},null,8,["modelValue","rules"])):m("",!0),t.value?(d(),i(r,{key:3,modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=e=>c.value=e),label:"น้ำหนัก",type:"number",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกน้ำหนัก"]},null,8,["modelValue","rules"])):m("",!0),t.value?(d(),I("div",A,[l[11]||(l[11]=w("div",{class:"text-grey-7 q-mb-sm",style:{"font-size":"14px"}},"เพศ",-1)),w("div",E,[a(f,{modelValue:s.value,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value=e),val:"male",label:"ชาย",dense:"",color:"primary"},null,8,["modelValue"]),a(f,{modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value=e),val:"female",label:"หญิง",dense:"",color:"pink"},null,8,["modelValue"]),a(f,{modelValue:s.value,"onUpdate:modelValue":l[6]||(l[6]=e=>s.value=e),val:"lgbtq",label:"LGBTQ+",dense:"",color:"purple"},null,8,["modelValue"]),a(f,{modelValue:s.value,"onUpdate:modelValue":l[7]||(l[7]=e=>s.value=e),val:"not_specified",label:"ไม่ระบุ",dense:"",color:"grey"},null,8,["modelValue"])])])):m("",!0),a(r,{modelValue:v.value,"onUpdate:modelValue":l[8]||(l[8]=e=>v.value=e),label:"อีเมล",type:"email",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกอีเมล"]},null,8,["modelValue","rules"]),a(r,{modelValue:p.value,"onUpdate:modelValue":l[9]||(l[9]=e=>p.value=e),label:"รหัสผ่าน",type:"password",dense:"",outlined:"","lazy-rules":"",rules:[e=>e&&e.length>0||"กรุณากรอกรหัสผ่าน"]},null,8,["modelValue","rules"]),t.value?(d(),i(r,{key:5,modelValue:N.value,"onUpdate:modelValue":l[10]||(l[10]=e=>N.value=e),label:"ยืนยันรหัสผ่าน",type:"password",dense:"",outlined:"",rules:[e=>e===p.value||"รหัสผ่านไม่ตรงกัน"]},null,8,["modelValue","rules"])):m("",!0)]),_:1}),a(R,{class:"q-px-md q-pb-md column q-gutter-sm"},{default:u(()=>[a(S,{onClick:z,color:"primary",class:"full-width",loading:n.value},{loading:u(()=>[a(T,{class:"on-left"}),l[12]||(l[12]=k(" กำลังติดต่อ Server... ",-1))]),default:u(()=>[k(x(t.value?"ยืนยันการสมัคร":"เข้าสู่ระบบ")+" ",1)]),_:1},8,["loading"]),a(S,{flat:"",color:"secondary",class:"full-width",onClick:h},{default:u(()=>[k(x(t.value?"มีบัญชีอยู่แล้ว? เข้าสู่ระบบ":"ยังไม่มีบัญชี? สมัครสมาชิก"),1)]),_:1})]),_:1})]),_:1})]),_:1}))}});export{G as default};
